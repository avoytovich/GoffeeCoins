<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js.map"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.slim.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.slim.js.map"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script>
    var socket = io.connect('http://localhost:8030', {
        'query': 'token=' + 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI4MVE1cUZQNzNjTkVUM0M2dGZQOVQ0cUx5UXgxIiwidHlwZSI6IkFkbWluIiwicm9sZSI6Ik9XTkVSIiwiaWF0IjoxNTExODc5MjY4fQ.MvWo5MK3IP2L8RFPo5e9OFAvKGMRN-AW4wzFpEhLcII'
    });

    var visitors;

    socket.on('connect', function() {

        socket.emit('hello', 'Adminskyi');

        setTimeout(function () {
            socket.emit('inCoffeeHouse', '5a0062a4e29b7a3f9abe335e');
        }, 3000);
    });

    socket.on('world', function (mes) {
        console.log('world', mes);
    });

    socket.on('listOfCurrentVisitors', function (mes) {
        console.log('listOfCurrentVisitors', mes);
        visitors = mes;
        console.log(visitors);
    });

    socket.on('newUserInCoffeeHouse', function (mes) {
        console.log('newUserInCoffeeHouse', mes);
        visitors.push(mes);
        console.log(visitors);
    });

    socket.on('userLeaveCoffeeHouse', function (mes) {
        console.log('userLeaveCoffeeHouse', mes);
        visitors = visitors.filter(function (item) {
            return String(item._id) !== String(mes);
        });
        console.log(visitors);
    });

    socket.on('error', function (err) {
        console.log('error', err.message);
    });
</script>
</body>
</html>